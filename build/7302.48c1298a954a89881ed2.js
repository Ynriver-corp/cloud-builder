"use strict";(self.webpackChunkcloud_builder=self.webpackChunkcloud_builder||[]).push([[7302],{7441:function(e,t,i){i.r(t),i.d(t,{DragAndDropController:function(){return u}});var s=i(5976),n=i(1432),o=i(16830),r=i(50187),a=i(24314),l=i(3860);class d{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){let i=e.getValueInRange(this.selection);this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new a.e(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),!this.selection.containsPosition(this.targetPosition)||this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition))?this.copy?this.targetSelection=new l.Y(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber>this.selection.endLineNumber?this.targetSelection=new l.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber<this.selection.endLineNumber?this.targetSelection=new l.Y(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new l.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,(this.selection.startLineNumber,this.selection.endLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn),this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new l.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn):this.targetSelection=this.selection}computeCursorState(e,t){return this.targetSelection}}var h=i(83103);function c(e){return n.dz?e.altKey:e.ctrlKey}class u extends s.JT{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._register(this._editor.onMouseDrag((e=>this._onEditorMouseDrag(e)))),this._register(this._editor.onMouseDrop((e=>this._onEditorMouseDrop(e)))),this._register(this._editor.onMouseDropCanceled((()=>this._onEditorMouseDropCanceled()))),this._register(this._editor.onKeyDown((e=>this.onEditorKeyDown(e)))),this._register(this._editor.onKeyUp((e=>this.onEditorKeyUp(e)))),this._register(this._editor.onDidBlurEditorWidget((()=>this.onEditorBlur()))),this._register(this._editor.onDidBlurEditorText((()=>this.onEditorBlur()))),this._dndDecorationIds=[],this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){this._editor.getOption(29)&&!this._editor.getOption(16)&&(c(e)&&(this._modifierPressed=!0),this._mouseDown&&c(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){this._editor.getOption(29)&&!this._editor.getOption(16)&&(c(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===u.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){let t=e.target;if(null===this._dragSelection){let e=(this._editor.getSelections()||[]).filter((e=>t.position&&e.containsPosition(t.position)));if(1!==e.length)return;this._dragSelection=e[0]}c(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){let t=new r.L(e.target.position.lineNumber,e.target.position.column);if(null===this._dragSelection){let i=null;if(e.event.shiftKey){let e=this._editor.getSelection();if(e){const{selectionStartLineNumber:s,selectionStartColumn:n}=e;i=[new l.Y(s,n,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map((e=>e.containsPosition(t)?new l.Y(t.lineNumber,t.column,t.lineNumber,t.column):e));this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(c(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(u.ID,new d(this._dragSelection,t,c(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){let t=[{range:new a.e(e.lineNumber,e.column,e.lineNumber,e.column),options:u._DECORATION_OPTIONS}];this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,t),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,[])}_hitContent(e){return 6===e.type||7===e.type}_hitMargin(e){return 2===e.type||3===e.type||4===e.type}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}u.ID="editor.contrib.dragAndDrop",u.TRIGGER_KEY_VALUE=n.dz?6:5,u._DECORATION_OPTIONS=h.qx.register({description:"dnd-target",className:"dnd-target"}),(0,o._K)(u.ID,u)},81372:function(e,t,i){i.r(t),i.d(t,{getDocumentSymbols:function(){return c}});var s=i(70666),n=i(51200),o=i(71050),r=i(88216),a=i(86895),l=i(94565),d=i(98401),h=function(e,t,i,s){return new(i||(i=Promise))((function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((s=s.apply(e,t||[])).next())}))};function c(e,t,i){return h(this,void 0,void 0,(function*(){const s=yield a.C3.create(e,i);return t?s.asListOfDocumentSymbols():s.getTopLevelSymbols()}))}l.P.registerCommand("_executeDocumentSymbolProvider",(function(e,...t){return h(this,void 0,void 0,(function*(){const[i]=t;(0,d.p_)(s.o.isUri(i));const a=e.get(n.q).getModel(i);if(a)return c(a,!1,o.T.None);const l=yield e.get(r.S).createModelReference(i);try{return yield c(l.object.textEditorModel,!1,o.T.None)}finally{l.dispose()}}))}))},86895:function(e,t,i){i.d(t,{C3:function(){return p}});var s=i(9488),n=i(71050),o=i(17301),r=i(43702),a=i(24314),l=i(44101),d=i(53725),h=i(21036);class c{remove(){this.parent&&this.parent.children.delete(this.id)}static findId(e,t){let i;"string"==typeof e?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,void 0!==t.children.get(i)&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let s=i;for(let e=0;void 0!==t.children.get(s);e++)s=`${i}_${e}`;return s}static empty(e){return 0===e.children.size}}class u extends c{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class g extends c{constructor(e,t,i,s){super(),this.id=e,this.parent=t,this.label=i,this.order=s,this.children=new Map}}class p extends c{constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}static create(e,t){let i=this._keys.for(e,!0),s=p._requests.get(i);if(!s){let t=new n.A;s={promiseCnt:0,source:t,promise:p._create(e,t.token),model:void 0},p._requests.set(i,s);const o=Date.now();s.promise.then((()=>{this._requestDurations.update(e,Date.now()-o)}))}return s.model?Promise.resolve(s.model):(s.promiseCnt+=1,t.onCancellationRequested((()=>{0==--s.promiseCnt&&(s.source.cancel(),p._requests.delete(i))})),new Promise(((e,t)=>{s.promise.then((t=>{s.model=t,e(t)}),(e=>{p._requests.delete(i),t(e)}))})))}static _create(e,t){const i=new n.A(t),r=new p(e.uri),a=l.vJ.ordered(e),d=a.map(((t,s)=>{var n;let a=c.findId(`provider_${s}`,r),l=new g(a,r,null!==(n=t.displayName)&&void 0!==n?n:"Unknown Outline Provider",s);return Promise.resolve(t.provideDocumentSymbols(e,i.token)).then((e=>{for(const t of e||[])p._makeOutlineElement(t,l);return l}),(e=>((0,o.Cp)(e),l))).then((e=>{c.empty(e)?e.remove():r._groups.set(a,e)}))})),h=l.vJ.onDidChange((()=>{const t=l.vJ.ordered(e);(0,s.fS)(t,a)||i.cancel()}));return Promise.all(d).then((()=>i.token.isCancellationRequested&&!t.isCancellationRequested?p._create(e,t):r._compact())).finally((()=>{h.dispose()}))}static _makeOutlineElement(e,t){let i=c.findId(e,t),s=new u(i,t,e);if(e.children)for(const t of e.children)p._makeOutlineElement(t,s);t.children.set(s.id,s)}_compact(){let e=0;for(const[t,i]of this._groups)0===i.children.size?this._groups.delete(t):e+=1;if(1!==e)this.children=this._groups;else{let e=d.$.first(this._groups.values());for(let[,t]of e.children)t.parent=this,this.children.set(t.id,t)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof u?e.push(t.symbol):e.push(...d.$.map(t.children.values(),(e=>e.symbol)));return e.sort(((e,t)=>a.e.compareRangesUsingStarts(e.range,t.range)))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return p._flattenDocumentSymbols(t,e,""),t.sort(((e,t)=>a.e.compareRangesUsingStarts(e.range,t.range)))}static _flattenDocumentSymbols(e,t,i){for(const s of t)e.push({kind:s.kind,tags:s.tags,name:s.name,detail:s.detail,containerName:s.containerName||i,range:s.range,selectionRange:s.selectionRange,children:void 0}),s.children&&p._flattenDocumentSymbols(e,s.children,s.name)}}p._requestDurations=new h.Y(l.vJ,350),p._requests=new r.z6(9,.75),p._keys=new class{constructor(){this._counter=1,this._data=new WeakMap}for(e,t){return`${e.id}/${t?e.getVersionId():""}/${this._hash(l.vJ.all(e))}`}_hash(e){let t="";for(const i of e){let e=this._data.get(i);void 0===e&&(e=this._counter++,this._data.set(i,e)),t+=e}return t}}},61838:function(e,t,i){i.r(t),i.d(t,{CommonFindController:function(){return it},FindController:function(){return st},MatchFindAction:function(){return rt},NextMatchFindAction:function(){return at},NextSelectionMatchFindAction:function(){return ht},PreviousMatchFindAction:function(){return lt},PreviousSelectionMatchFindAction:function(){return ct},SelectionMatchFindAction:function(){return dt},StartFindAction:function(){return nt},StartFindReplaceAction:function(){return ut},StartFindWithSelectionAction:function(){return ot},getSelectionSearchString:function(){return tt}});var s=i(63580),n=i(15393),o=i(5976),r=i(97295),a=i(16830),l=i(29102),d=i(61329),h=i(50187),c=i(24314),u=i(3860),g=i(77277),p=i(84973),_=i(83103),m=i(73910),f=i(97781);class v{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.deltaDecorations(this._allDecorations(),[]),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map((e=>this._editor.getModel().getDecorationRange(e))).filter((e=>!!e));if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getCurrentMatchesPosition(e){let t=this._editor.getModel().getDecorationsInRange(e);for(const e of t){const t=e.options;if(t===v._FIND_MATCH_DECORATION||t===v._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(e.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let s=0,n=this._decorations.length;s<n;s++){let n=this._editor.getModel().getDecorationRange(this._decorations[s]);if(e.equalsRange(n)){t=this._decorations[s],i=s+1;break}}return null===this._highlightedDecorationId&&null===t||this._editor.changeDecorations((e=>{if(null!==this._highlightedDecorationId&&(e.changeDecorationOptions(this._highlightedDecorationId,v._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),null!==t&&(this._highlightedDecorationId=t,e.changeDecorationOptions(this._highlightedDecorationId,v._CURRENT_FIND_MATCH_DECORATION)),null!==this._rangeHighlightDecorationId&&(e.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),null!==t){let i=this._editor.getModel().getDecorationRange(t);if(i.startLineNumber!==i.endLineNumber&&1===i.endColumn){let e=i.endLineNumber-1,t=this._editor.getModel().getLineMaxColumn(e);i=new c.e(i.startLineNumber,i.startColumn,e,t)}this._rangeHighlightDecorationId=e.addDecoration(i,v._RANGE_HIGHLIGHT_DECORATION)}})),i}set(e,t){this._editor.changeDecorations((i=>{let s=v._FIND_MATCH_DECORATION,n=[];if(e.length>1e3){s=v._FIND_MATCH_NO_OVERVIEW_DECORATION;const t=this._editor.getModel().getLineCount(),i=this._editor.getLayoutInfo().height/t,o=Math.max(2,Math.ceil(3/i));let r=e[0].range.startLineNumber,a=e[0].range.endLineNumber;for(let t=1,i=e.length;t<i;t++){const i=e[t].range;a+o>=i.startLineNumber?i.endLineNumber>a&&(a=i.endLineNumber):(n.push({range:new c.e(r,1,a,1),options:v._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),r=i.startLineNumber,a=i.endLineNumber)}n.push({range:new c.e(r,1,a,1),options:v._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}let o=new Array(e.length);for(let t=0,i=e.length;t<i;t++)o[t]={range:e[t].range,options:s};this._decorations=i.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,n),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach((e=>i.removeDecoration(e))),this._findScopeDecorationIds=[]),(null==t?void 0:t.length)&&(this._findScopeDecorationIds=t.map((e=>i.addDecoration(e,v._FIND_SCOPE_DECORATION))))}))}matchBeforePosition(e){if(0===this._decorations.length)return null;for(let t=this._decorations.length-1;t>=0;t--){let i=this._decorations[t],s=this._editor.getModel().getDecorationRange(i);if(s&&!(s.endLineNumber>e.lineNumber)){if(s.endLineNumber<e.lineNumber)return s;if(!(s.endColumn>e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(0===this._decorations.length)return null;for(let t=0,i=this._decorations.length;t<i;t++){let i=this._decorations[t],s=this._editor.getModel().getDecorationRange(i);if(s&&!(s.startLineNumber<e.lineNumber)){if(s.startLineNumber>e.lineNumber)return s;if(!(s.startColumn<e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}v._CURRENT_FIND_MATCH_DECORATION=_.qx.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:(0,f.EN)(m.Fm),position:p.sh.Center},minimap:{color:(0,f.EN)(m.KT),position:p.F5.Inline}}),v._FIND_MATCH_DECORATION=_.qx.register({description:"find-match",stickiness:1,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:(0,f.EN)(m.Fm),position:p.sh.Center},minimap:{color:(0,f.EN)(m.KT),position:p.F5.Inline}}),v._FIND_MATCH_NO_OVERVIEW_DECORATION=_.qx.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),v._FIND_MATCH_ONLY_OVERVIEW_DECORATION=_.qx.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:(0,f.EN)(m.Fm),position:p.sh.Center}}),v._RANGE_HIGHLIGHT_DECORATION=_.qx.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),v._FIND_SCOPE_DECORATION=_.qx.register({description:"find-scope",className:"findScope",isWholeLine:!0});class S{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){let e=[];for(let t=0;t<this._ranges.length;t++)e.push({range:this._ranges[t],text:this._replaceStrings[t]});e.sort(((e,t)=>c.e.compareRangesUsingStarts(e.range,t.range)));let i=[],s=e[0];for(let t=1;t<e.length;t++)s.range.endLineNumber===e[t].range.startLineNumber&&s.range.endColumn===e[t].range.startColumn?(s.range=s.range.plusRange(e[t].range),s.text=s.text+e[t].text):(i.push(s),s=e[t]);i.push(s);for(const e of i)t.addEditOperation(e.range,e.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}var b=i(29415);class C{constructor(e){this.staticValue=e,this.kind=0}}class N{constructor(e){this.pieces=e,this.kind=1}}class R{constructor(e){e&&0!==e.length?1===e.length&&null!==e[0].staticValue?this._state=new C(e[0].staticValue):this._state=new N(e):this._state=new C("")}static fromStaticValue(e){return new R([x.staticValue(e)])}get hasReplacementPatterns(){return 1===this._state.kind}buildReplaceString(e,t){if(0===this._state.kind)return t?(0,b.o)(e,this._state.staticValue):this._state.staticValue;let i="";for(let t=0,s=this._state.pieces.length;t<s;t++){let s=this._state.pieces[t];if(null!==s.staticValue){i+=s.staticValue;continue}let n=R._substitute(s.matchIndex,e);if(null!==s.caseOps&&s.caseOps.length>0){let e=[],t=s.caseOps.length,i=0;for(let o=0,r=n.length;o<r;o++){if(i>=t){e.push(n.slice(o));break}switch(s.caseOps[i]){case"U":e.push(n[o].toUpperCase());break;case"u":e.push(n[o].toUpperCase()),i++;break;case"L":e.push(n[o].toLowerCase());break;case"l":e.push(n[o].toLowerCase()),i++;break;default:e.push(n[o])}}n=e.join("")}i+=n}return i}static _substitute(e,t){if(null===t)return"";if(0===e)return t[0];let i="";for(;e>0;){if(e<t.length){return(t[e]||"")+i}i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class x{constructor(e,t,i){this.staticValue=e,this.matchIndex=t,i&&0!==i.length?this.caseOps=i.slice(0):this.caseOps=null}static staticValue(e){return new x(e,-1,null)}static caseOps(e,t){return new x(null,e,t)}}class I{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){0!==e.length&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=x.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=x.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=x.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new R(this._result)}}var w=i(38819),y=i(9488);const L=new w.uy("findWidgetVisible",!1),E=new w.uy("findInputFocussed",!1),D=new w.uy("replaceInputFocussed",!1),M={primary:545,mac:{primary:2593}},F={primary:565,mac:{primary:2613}},O={primary:560,mac:{primary:2608}},A={primary:554,mac:{primary:2602}},P={primary:558,mac:{primary:2606}},k="actions.find",T="actions.findWithSelection",B="editor.action.nextMatchFindAction",V="editor.action.previousMatchFindAction",W="editor.action.nextSelectionMatchFindAction",H="editor.action.previousSelectionMatchFindAction",U="editor.action.startFindReplaceAction",q="closeFindWidget",$="toggleFindCaseSensitive",K="toggleFindWholeWord",Z="toggleFindRegex",G="toggleFindInSelection",z="togglePreserveCase",Q="editor.action.replaceOne",X="editor.action.replaceAll",Y="editor.action.selectAllMatches",j=19999;class J{constructor(e,t){this._toDispose=new o.SL,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new n._F,this._decorations=new v(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new n.pY((()=>this.research(!1)),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition((e=>{3!==e.reason&&5!==e.reason&&6!==e.reason||this._decorations.setStartPosition(this._editor.getPosition())}))),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent((e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())}))),this._toDispose.add(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,(0,o.B9)(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){if(!this._isDisposed&&this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)){this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet((()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}),240)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;void 0!==t?null!==t&&(i=Array.isArray(t)?t:[t]):i=this._decorations.getFindScopes(),null!==i&&(i=i.map((e=>{if(e.startLineNumber!==e.endLineNumber){let t=e.endLineNumber;return 1===e.endColumn&&(t-=1),new c.e(e.startLineNumber,1,t,this._editor.getModel().getLineMaxColumn(t))}return e})));let s=this._findMatches(i,!1,j);this._decorations.set(s,i);const n=this._editor.getSelection();let o=this._decorations.getCurrentMatchesPosition(n);if(0===o&&s.length>0){const e=(0,y.lG)(s.map((e=>e.range)),(e=>c.e.compareRangesUsingStarts(e,n)>=0));o=e>0?e-1+1:o}this._state.changeMatchInfo(o,this._decorations.getCount(),void 0),e&&this._editor.getOption(33).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){let e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){let t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:i,column:s}=e,n=this._editor.getModel();return t||1===s?(1===i?i=n.getLineCount():i--,s=n.getLineMaxColumn(i)):s--,new h.L(i,s)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const t=this._decorations.matchAfterPosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<j){let t=this._decorations.matchBeforePosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),t=this._decorations.matchBeforePosition(e)),void(t&&this._setCurrentFindMatch(t))}if(this._cannotFind())return;let i=this._decorations.getFindScope(),s=J._getSearchRange(this._editor.getModel(),i);s.getEndPosition().isBefore(e)&&(e=s.getEndPosition()),e.isBefore(s.getStartPosition())&&(e=s.getEndPosition());let{lineNumber:n,column:o}=e,r=this._editor.getModel(),a=new h.L(n,o),l=r.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,!1);return l&&l.range.isEmpty()&&l.range.getStartPosition().equals(a)&&(a=this._prevSearchPosition(a),l=r.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,!1)),l?t||s.containsRange(l.range)?void this._setCurrentFindMatch(l.range):this._moveToPrevMatch(l.range.getStartPosition(),!0):void 0}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:i,column:s}=e,n=this._editor.getModel();return t||s===n.getLineMaxColumn(i)?(i===n.getLineCount()?i=1:i++,s=1):s++,new h.L(i,s)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const t=this._decorations.matchBeforePosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<j){let t=this._decorations.matchAfterPosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),t=this._decorations.matchAfterPosition(e)),void(t&&this._setCurrentFindMatch(t))}let t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,s=!1){if(this._cannotFind())return null;let n=this._decorations.getFindScope(),o=J._getSearchRange(this._editor.getModel(),n);o.getEndPosition().isBefore(e)&&(e=o.getStartPosition()),e.isBefore(o.getStartPosition())&&(e=o.getStartPosition());let{lineNumber:r,column:a}=e,l=this._editor.getModel(),d=new h.L(r,a),c=l.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,t);return i&&c&&c.range.isEmpty()&&c.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),c=l.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,t)),c?s||o.containsRange(c.range)?c:this._getNextMatch(c.range.getEndPosition(),t,i,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?function(e){if(!e||0===e.length)return new R(null);let t=[],i=new I(e);for(let s=0,n=e.length;s<n;s++){let o=e.charCodeAt(s);if(92!==o){if(36===o){if(s++,s>=n)break;let o=e.charCodeAt(s);if(36===o){i.emitUnchanged(s-1),i.emitStatic("$",s+1);continue}if(48===o||38===o){i.emitUnchanged(s-1),i.emitMatchIndex(0,s+1,t),t.length=0;continue}if(49<=o&&o<=57){let r=o-48;if(s+1<n){let n=e.charCodeAt(s+1);if(48<=n&&n<=57){s++,r=10*r+(n-48),i.emitUnchanged(s-2),i.emitMatchIndex(r,s+1,t),t.length=0;continue}}i.emitUnchanged(s-1),i.emitMatchIndex(r,s+1,t),t.length=0;continue}}}else{if(s++,s>=n)break;let o=e.charCodeAt(s);switch(o){case 92:i.emitUnchanged(s-1),i.emitStatic("\\",s+1);break;case 110:i.emitUnchanged(s-1),i.emitStatic("\n",s+1);break;case 116:i.emitUnchanged(s-1),i.emitStatic("\t",s+1);break;case 117:case 85:case 108:case 76:i.emitUnchanged(s-1),i.emitStatic("",s+1),t.push(String.fromCharCode(o))}}}return i.finalize()}(this._state.replaceString):R.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;let e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){let s=e.buildReplaceString(i.matches,this._state.preserveCase),n=new d.T4(t,s);this._executeEditorCommand("replace",n),this._decorations.setStartPosition(new h.L(t.startLineNumber,t.startColumn+s.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const s=(e||[null]).map((e=>J._getSearchRange(this._editor.getModel(),e)));return this._editor.getModel().findMatches(this._state.searchString,s,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();null===e&&this._state.matchesCount>=j?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const e=new g.bc(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null).parseSearchRequest();if(!e)return;let t=e.regex;if(!t.multiline){let e="mu";t.ignoreCase&&(e+="i"),t.global&&(e+="g"),t=new RegExp(t.source,e)}const i=this._editor.getModel(),s=i.getValue(1),n=i.getFullModelRange(),o=this._getReplacePattern();let r;const a=this._state.preserveCase;r=o.hasReplacementPatterns||a?s.replace(t,(function(){return o.buildReplaceString(arguments,a)})):s.replace(t,o.buildReplaceString(null,a));let l=new d.hP(n,r,this._editor.getSelection());this._executeEditorCommand("replaceAll",l)}_regularReplaceAll(e){const t=this._getReplacePattern();let i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),s=[];for(let e=0,n=i.length;e<n;e++)s[e]=t.buildReplaceString(i[e].matches,this._state.preserveCase);let n=new S(this._editor.getSelection(),i.map((e=>e.range)),s);this._executeEditorCommand("replaceAll",n)}selectAllMatches(){if(!this._hasMatches())return;let e=this._decorations.getFindScopes(),t=this._findMatches(e,!1,1073741824).map((e=>new u.Y(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn))),i=this._editor.getSelection();for(let e=0,s=t.length;e<s;e++){if(t[e].equalsRange(i)){t=[i].concat(t.slice(0,e)).concat(t.slice(e+1));break}}this._editor.setSelections(t)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}var ee=i(65321),te=i(3331),ie=i(93794);class se extends ie.${constructor(e,t,i,s){super(),this._hideSoon=this._register(new n.pY((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const o=s.getColorTheme().getColor(m.PR),r=s.getColorTheme().getColor(m.Pv),a=s.getColorTheme().getColor(m.XE);this.caseSensitive=this._register(new te.vk({appendTitle:this._keybindingLabelFor($),isChecked:this._state.matchCase,inputActiveOptionBorder:o,inputActiveOptionForeground:r,inputActiveOptionBackground:a})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new te.n3({appendTitle:this._keybindingLabelFor(K),isChecked:this._state.wholeWord,inputActiveOptionBorder:o,inputActiveOptionForeground:r,inputActiveOptionBackground:a})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new te.am({appendTitle:this._keybindingLabelFor(Z),isChecked:this._state.isRegex,inputActiveOptionBorder:o,inputActiveOptionForeground:r,inputActiveOptionBackground:a})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((e=>{let t=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()}))),this._register(ee.j_(this._domNode,(e=>this._onMouseOut()))),this._register(ee.nm(this._domNode,"mouseover",(e=>this._onMouseOver()))),this._applyTheme(s.getColorTheme()),this._register(s.onDidColorThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return se.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseOut(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(m.PR),inputActiveOptionForeground:e.getColor(m.Pv),inputActiveOptionBackground:e.getColor(m.XE)};this.caseSensitive.style(t),this.wholeWords.style(t),this.regex.style(t)}}se.ID="editor.contrib.findOptionsWidget",(0,f.Ic)(((e,t)=>{const i=e.getColor(m.D0);i&&t.addRule(`.monaco-editor .findOptionsWidget { background-color: ${i}; }`);const s=e.getColor(m.Hf);s&&t.addRule(`.monaco-editor .findOptionsWidget { color: ${s}; }`);const n=e.getColor(m.rh);n&&t.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${n}; }`);const o=e.getColor(m.lR);o&&t.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${o}; }`)}));var ne=i(4669);function oe(e,t){return 1===e||2!==e&&t}class re extends o.JT{constructor(){super(),this._onFindReplaceStateChange=this._register(new ne.Q5),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return oe(this._isRegexOverride,this._isRegex)}get wholeWord(){return oe(this._wholeWordOverride,this._wholeWord)}get matchCase(){return oe(this._matchCaseOverride,this._matchCase)}get preserveCase(){return oe(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}changeMatchInfo(e,t,i){let s={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},n=!1;0===t&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,s.matchesPosition=!0,n=!0),this._matchesCount!==t&&(this._matchesCount=t,s.matchesCount=!0,n=!0),void 0!==i&&(c.e.equalsRange(this._currentMatch,i)||(this._currentMatch=i,s.currentMatch=!0,n=!0)),n&&this._onFindReplaceStateChange.fire(s)}change(e,t,i=!0){var s;let n={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},o=!1;const r=this.isRegex,a=this.wholeWord,l=this.matchCase,d=this.preserveCase;void 0!==e.searchString&&this._searchString!==e.searchString&&(this._searchString=e.searchString,n.searchString=!0,o=!0),void 0!==e.replaceString&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,n.replaceString=!0,o=!0),void 0!==e.isRevealed&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,n.isRevealed=!0,o=!0),void 0!==e.isReplaceRevealed&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,n.isReplaceRevealed=!0,o=!0),void 0!==e.isRegex&&(this._isRegex=e.isRegex),void 0!==e.wholeWord&&(this._wholeWord=e.wholeWord),void 0!==e.matchCase&&(this._matchCase=e.matchCase),void 0!==e.preserveCase&&(this._preserveCase=e.preserveCase),void 0!==e.searchScope&&((null===(s=e.searchScope)||void 0===s?void 0:s.every((e=>{var t;return null===(t=this._searchScope)||void 0===t?void 0:t.some((t=>!c.e.equalsRange(t,e)))})))||(this._searchScope=e.searchScope,n.searchScope=!0,o=!0)),void 0!==e.loop&&this._loop!==e.loop&&(this._loop=e.loop,n.loop=!0,o=!0),this._isRegexOverride=void 0!==e.isRegexOverride?e.isRegexOverride:0,this._wholeWordOverride=void 0!==e.wholeWordOverride?e.wholeWordOverride:0,this._matchCaseOverride=void 0!==e.matchCaseOverride?e.matchCaseOverride:0,this._preserveCaseOverride=void 0!==e.preserveCaseOverride?e.preserveCaseOverride:0,r!==this.isRegex&&(o=!0,n.isRegex=!0),a!==this.wholeWord&&(o=!0,n.wholeWord=!0),l!==this.matchCase&&(o=!0,n.matchCase=!0),d!==this.preserveCase&&(o=!0,n.preserveCase=!0),o&&this._onFindReplaceStateChange.fire(n)}canNavigateBack(){return this.canNavigateInLoop()||1!==this.matchesPosition}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=j}}var ae=i(85152),le=i(16229),de=i(73098),he=i(17301),ce=i(1432),ue=i(46765),ge=i(73046),pe=i(59554),_e=function(e,t,i,s){return new(i||(i=Promise))((function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((s=s.apply(e,t||[])).next())}))};const me=(0,pe.q5)("find-selection",ge.lA.selection,s.N("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),fe=(0,pe.q5)("find-collapsed",ge.lA.chevronRight,s.N("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),ve=(0,pe.q5)("find-expanded",ge.lA.chevronDown,s.N("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),Se=(0,pe.q5)("find-replace",ge.lA.replace,s.N("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),be=(0,pe.q5)("find-replace-all",ge.lA.replaceAll,s.N("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),Ce=(0,pe.q5)("find-previous-match",ge.lA.arrowUp,s.N("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),Ne=(0,pe.q5)("find-next-match",ge.lA.arrowDown,s.N("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),Re=s.N("label.find","Find"),xe=s.N("placeholder.find","Find"),Ie=s.N("label.previousMatchButton","Previous Match"),we=s.N("label.nextMatchButton","Next Match"),ye=s.N("label.toggleSelectionFind","Find in Selection"),Le=s.N("label.closeButton","Close"),Ee=s.N("label.replace","Replace"),De=s.N("placeholder.replace","Replace"),Me=s.N("label.replaceButton","Replace"),Fe=s.N("label.replaceAllButton","Replace All"),Oe=s.N("label.toggleReplaceButton","Toggle Replace"),Ae=s.N("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",j),Pe=s.N("label.matchesLocation","{0} of {1}"),ke=s.N("label.noResults","No results"),Te=419;let Be=69;const Ve="ctrlEnterReplaceAll.windows.donotask",We=ce.dz?256:2048;class He{constructor(e){this.afterLineNumber=e,this.heightInPx=33,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function Ue(e,t,i){const s=!!t.match(/\n/);i&&s&&i.selectionStart>0&&e.stopPropagation()}function qe(e,t,i){const s=!!t.match(/\n/);i&&s&&i.selectionEnd<i.value.length&&e.stopPropagation()}class $e extends ie.${constructor(e,t,i,s,r,a,l,d,h){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=s,this._keybindingService=r,this._contextKeyService=a,this._storageService=d,this._notificationService=h,this._ctrlEnterReplaceAllWarningPrompted=!!d.getBoolean(Ve,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new n.vp(500),this._register((0,o.OF)((()=>this._updateHistoryDelayer.cancel()))),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration((e=>{if(e.hasChanged(79)&&(this._codeEditor.getOption(79)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.hasChanged(129)&&this._tryUpdateWidgetWidth(),e.hasChanged(2)&&this.updateAccessibilitySupport(),e.hasChanged(33)){const e=this._codeEditor.getOption(33).addExtraSpaceOnTop;e&&!this._viewZone&&(this._viewZone=new He(0),this._showViewZone()),!e&&this._viewZone&&this._removeViewZone()}}))),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection((()=>{this._isVisible&&this._updateToggleSelectionFindButton()}))),this._register(this._codeEditor.onDidFocusEditorWidget((()=>_e(this,void 0,void 0,(function*(){if(this._isVisible){let e=yield this._controller.getGlobalBufferTerm();e&&e!==this._state.searchString&&(this._state.change({searchString:e},!1),this._findInput.select())}}))))),this._findInputFocused=E.bindTo(a),this._findFocusTracker=this._register(ee.go(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus((()=>{this._findInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._findFocusTracker.onDidBlur((()=>{this._findInputFocused.set(!1)}))),this._replaceInputFocused=D.bindTo(a),this._replaceFocusTracker=this._register(ee.go(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus((()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._replaceFocusTracker.onDidBlur((()=>{this._replaceInputFocused.set(!1)}))),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(33).addExtraSpaceOnTop&&(this._viewZone=new He(0)),this._applyTheme(l.getColorTheme()),this._register(l.onDidColorThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel((()=>{this._isVisible&&(this._viewZoneId=void 0)}))),this._register(this._codeEditor.onDidScrollChange((e=>{e.scrollTopChanged?this._layoutViewZone():setTimeout((()=>{this._layoutViewZone()}),0)})))}getId(){return $e.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getOption(79)||this._isReplaceVisible||(this._isReplaceVisible=!0,this._replaceInput.width=ee.w(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){let e=this._state.searchString.length>0&&0===this._state.matchesCount;this._domNode.classList.toggle("no-results",e),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,he.dL)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){let e;if(this._matchesCount.style.minWidth=Be+"px",this._state.matchesCount>=j?this._matchesCount.title=Ae:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=j&&(t+="+");let i=String(this._state.matchesPosition);"0"===i&&(i="?"),e=r.WU(Pe,i,t)}else e=ke;this._matchesCount.appendChild(document.createTextNode(e)),(0,ae.Z9)(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),Be=Math.max(Be,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===ke)return""===i?s.N("ariaSearchNoResultEmpty","{0} found",e):s.N("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const n=s.N("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),o=this._codeEditor.getModel();if(o&&t.startLineNumber<=o.getLineCount()&&t.startLineNumber>=1){return`${o.getLineContent(t.startLineNumber)}, ${n}`}return n}return s.N("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){let e=this._codeEditor.getSelection(),t=!!e&&(e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn),i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);let e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);let i=!this._codeEditor.getOption(79);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(33).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":const t=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=t}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout((()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")}),0)),this._revealTimeouts.push(setTimeout((()=>{this._findInput.validate()}),200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(33).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const s=ee.i(i),n=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),o=s.left+(n?n.left:0),r=n?n.top:0;if(this._viewZone&&r<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const i=ee.xQ(this._domNode).left;o>i&&(t=!1);const n=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());s.left+(n?n.left:0)>i&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(33).addExtraSpaceOnTop)return void this._removeViewZone();if(!this._isVisible)return;const t=this._viewZone;void 0===this._viewZoneId&&t&&this._codeEditor.changeViewZones((i=>{t.heightInPx=this._getHeight(),this._viewZoneId=i.addZone(t),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+t.heightInPx)}))}_showViewZone(e=!0){if(!this._isVisible)return;if(!this._codeEditor.getOption(33).addExtraSpaceOnTop)return;void 0===this._viewZone&&(this._viewZone=new He(0));const t=this._viewZone;this._codeEditor.changeViewZones((i=>{if(void 0!==this._viewZoneId){const s=this._getHeight();if(s===t.heightInPx)return;let n=s-t.heightInPx;return t.heightInPx=s,i.layoutZone(this._viewZoneId),void(e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+n))}{let s=this._getHeight();if(s-=this._codeEditor.getOption(73).top,s<=0)return;t.heightInPx=s,this._viewZoneId=i.addZone(t),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+s)}}))}_removeViewZone(){this._codeEditor.changeViewZones((e=>{void 0!==this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))}))}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(m.PR),inputActiveOptionBackground:e.getColor(m.XE),inputActiveOptionForeground:e.getColor(m.Pv),inputBackground:e.getColor(m.sE),inputForeground:e.getColor(m.zJ),inputBorder:e.getColor(m.dt),inputValidationInfoBackground:e.getColor(m._l),inputValidationInfoForeground:e.getColor(m.YI),inputValidationInfoBorder:e.getColor(m.EP),inputValidationWarningBackground:e.getColor(m.RV),inputValidationWarningForeground:e.getColor(m.SU),inputValidationWarningBorder:e.getColor(m.C3),inputValidationErrorBackground:e.getColor(m.p),inputValidationErrorForeground:e.getColor(m._t),inputValidationErrorBorder:e.getColor(m.OZ)};this._findInput.style(t),this._replaceInput.style(t),this._toggleSelectionFind.style(t)}_tryUpdateWidgetWidth(){if(!this._isVisible)return;if(!ee.Uw(this._domNode))return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0)return void this._domNode.classList.add("hiddenEditor");this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const t=e.width,i=e.minimap.minimapWidth;let s=!1,n=!1,o=!1;if(this._resized){if(ee.w(this._domNode)>Te)return this._domNode.style.maxWidth=t-28-i-15+"px",void(this._replaceInput.width=ee.w(this._findInput.domNode))}if(447+i>=t&&(n=!0),447+i-Be>=t&&(o=!0),447+i-Be>=t+50&&(s=!0),this._domNode.classList.toggle("collapsed-find-widget",s),this._domNode.classList.toggle("narrow-find-widget",o),this._domNode.classList.toggle("reduced-find-widget",n),o||s||(this._domNode.style.maxWidth=t-28-i-15+"px"),this._resized){this._findInput.inputBox.layout();let e=this._findInput.inputBox.element.clientWidth;e>0&&(this._replaceInput.width=e)}else this._isReplaceVisible&&(this._replaceInput.width=ee.w(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return(null===this._cachedHeight||this._cachedHeight!==e)&&(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){let e=this._codeEditor.getSelections();e.map((e=>{1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1)));const t=this._state.currentMatch;return e.startLineNumber===e.endLineNumber||c.e.equalsRange(e,t)?null:e})).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){return e.equals(3|We)?(this._findInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?Ue(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):e.equals(18)?qe(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):void 0}_onReplaceInputKeyDown(e){return e.equals(3|We)?(ce.ED&&ce.tY&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(s.N("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(Ve,!0,0,0)),this._replaceInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(1026)?(this._findInput.focus(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?Ue(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):e.equals(18)?qe(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):void 0}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new ue.Yb(null,this._contextViewProvider,{width:221,label:Re,placeholder:xe,appendCaseSensitiveLabel:this._keybindingLabelFor($),appendWholeWordsLabel:this._keybindingLabelFor(K),appendRegexLabel:this._keybindingLabelFor(Z),validation:e=>{if(0===e.length||!this._findInput.getRegex())return null;try{return new RegExp(e,"gu"),null}catch(e){return{content:e.message}}},flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118},this._contextKeyService,!0)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown((e=>this._onFindInputKeyDown(e)))),this._register(this._findInput.inputBox.onDidChange((()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)}))),this._register(this._findInput.onDidOptionChange((()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)}))),this._register(this._findInput.onCaseSensitiveKeyDown((e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),e.preventDefault())}))),this._register(this._findInput.onRegexKeyDown((e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),e.preventDefault())}))),this._register(this._findInput.inputBox.onDidHeightChange((e=>{this._tryUpdateHeight()&&this._showViewZone()}))),ce.IJ&&this._register(this._findInput.onMouseDown((e=>this._onFindInputMouseDown(e)))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new Ke({label:Ie+this._keybindingLabelFor(V),icon:Ce,onTrigger:()=>{this._codeEditor.getAction(V).run().then(void 0,he.dL)}})),this._nextBtn=this._register(new Ke({label:we+this._keybindingLabelFor(B),icon:Ne,onTrigger:()=>{this._codeEditor.getAction(B).run().then(void 0,he.dL)}}));let e=document.createElement("div");e.className="find-part",e.appendChild(this._findInput.domNode);const t=document.createElement("div");t.className="find-actions",e.appendChild(t),t.appendChild(this._matchesCount),t.appendChild(this._prevBtn.domNode),t.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new le.X({icon:me,title:ye+this._keybindingLabelFor(G),isChecked:!1})),this._register(this._toggleSelectionFind.onChange((()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let e=this._codeEditor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}else this._state.change({searchScope:null},!0)}))),t.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new Ke({label:Le+this._keybindingLabelFor(q),icon:pe.s_,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),t.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new ue.Nq(null,void 0,{label:Ee,placeholder:De,appendPreserveCaseLabel:this._keybindingLabelFor(z),history:[],flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown((e=>this._onReplaceInputKeyDown(e)))),this._register(this._replaceInput.inputBox.onDidChange((()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)}))),this._register(this._replaceInput.inputBox.onDidHeightChange((e=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()}))),this._register(this._replaceInput.onDidOptionChange((()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)}))),this._register(this._replaceInput.onPreserveCaseKeyDown((e=>{e.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),e.preventDefault())}))),this._replaceBtn=this._register(new Ke({label:Me+this._keybindingLabelFor(Q),icon:Se,onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new Ke({label:Fe+this._keybindingLabelFor(X),icon:be,onTrigger:()=>{this._controller.replaceAll()}}));let i=document.createElement("div");i.className="replace-part",i.appendChild(this._replaceInput.domNode);const s=document.createElement("div");s.className="replace-actions",i.appendChild(s),s.appendChild(this._replaceBtn.domNode),s.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new Ke({label:Oe,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=ee.w(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width="419px",this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(e),this._domNode.appendChild(i),this._resizeSash=new de.g(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let n=Te;this._register(this._resizeSash.onDidStart((()=>{n=ee.w(this._domNode)}))),this._register(this._resizeSash.onDidChange((e=>{this._resized=!0;let t=n+e.startX-e.currentX;if(t<Te)return;t>(parseFloat(ee.Dx(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=ee.w(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())}))),this._register(this._resizeSash.onDidReset((()=>{const e=ee.w(this._domNode);if(e<Te)return;let t=Te;if(!this._resized||e===Te){const e=this._codeEditor.getLayoutInfo();t=e.width-28-e.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=ee.w(this._findInput.domNode)),this._findInput.inputBox.layout()})))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(2!==e)}}$e.ID="editor.contrib.findWidget";class Ke extends ie.${constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+f.kS.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,(e=>{this._opts.onTrigger(),e.preventDefault()})),this.onkeydown(this._domNode,(e=>{if(e.equals(10)||e.equals(3))return this._opts.onTrigger(),void e.preventDefault();this._opts.onKeyDown&&this._opts.onKeyDown(e)}))}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...f.kS.asClassNameArray(fe)),this._domNode.classList.add(...f.kS.asClassNameArray(ve))):(this._domNode.classList.remove(...f.kS.asClassNameArray(ve)),this._domNode.classList.add(...f.kS.asClassNameArray(fe)))}}(0,f.Ic)(((e,t)=>{const i=(e,i)=>{i&&t.addRule(`.monaco-editor ${e} { background-color: ${i}; }`)};i(".findMatch",e.getColor(m.MU)),i(".currentFindMatch",e.getColor(m.ny)),i(".findScope",e.getColor(m.jU));i(".find-widget",e.getColor(m.D0));const s=e.getColor(m.rh);s&&t.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${s}; }`);const n=e.getColor(m.Ei);n&&t.addRule(`.monaco-editor .findMatch { border: 1px ${"hc"===e.type?"dotted":"solid"} ${n}; box-sizing: border-box; }`);const o=e.getColor(m.pn);o&&t.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${o}; padding: 1px; box-sizing: border-box; }`);const r=e.getColor(m.gk);r&&t.addRule(`.monaco-editor .findScope { border: 1px ${"hc"===e.type?"dashed":"solid"} ${r}; }`);const a=e.getColor(m.lR);a&&t.addRule(`.monaco-editor .find-widget { border: 1px solid ${a}; }`);const l=e.getColor(m.Hf);l&&t.addRule(`.monaco-editor .find-widget { color: ${l}; }`);const d=e.getColor(m.Id);d&&t.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${d}; }`);const h=e.getColor(m.Ng);if(h)t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${h}; }`);else{const i=e.getColor(m.D1);i&&t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${i}; }`)}const c=e.getColor(m.R8);c&&t.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${c}; }`)}));var Ze=i(84144),Ge=i(84972),ze=i(5606),Qe=i(91847),Xe=i(52365),Ye=i(59422),je=function(e,t,i,s){var n,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},Je=function(e,t){return function(i,s){t(i,s,e)}},et=function(e,t,i,s){return new(i||(i=Promise))((function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((s=s.apply(e,t||[])).next())}))};function tt(e,t="single",i=!1){if(!e.hasModel())return null;const s=e.getSelection();if("single"===t&&s.startLineNumber===s.endLineNumber||"multiple"===t)if(s.isEmpty()){const t=e.getConfiguredWordAtPosition(s.getStartPosition());if(t&&!1===i)return t.word}else if(e.getModel().getValueLengthInRange(s)<524288)return e.getModel().getValueInRange(s);return null}let it=class e extends o.JT{constructor(e,t,i,s){super(),this._editor=e,this._findWidgetVisible=L.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=s,this._updateHistoryDelayer=new n.vp(500),this._state=this._register(new re),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{let e=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(33).loop})})))}get editor(){return this._editor}static get(t){return t.getContribution(e.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,0),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,0),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,0),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!E.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._editor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=r.ec(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e){return et(this,void 0,void 0,(function*(){if(this.disposeModel(),!this._editor.hasModel())return;let t={isRevealed:!0};if("single"===e.seedSearchStringFromSelection){let i=tt(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);i&&(this._state.isRegex?t.searchString=r.ec(i):t.searchString=i)}else if("multiple"===e.seedSearchStringFromSelection&&!e.updateSearchScope){let i=tt(this._editor,e.seedSearchStringFromSelection);i&&(t.searchString=i)}if(!t.searchString&&e.seedSearchStringFromGlobalClipboard){let e=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;e&&(t.searchString=e)}if(e.forceRevealReplace?t.isReplaceRevealed=!0:this._findWidgetVisible.get()||(t.isReplaceRevealed=!1),e.updateSearchScope){let e=this._editor.getSelections();e.some((e=>!e.isEmpty()))&&(t.searchScope=e)}t.loop=e.loop,this._state.change(t,!1),this._model||(this._model=new J(this._editor,this._state))}))}start(e){return this._start(e)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){return!!this._model&&(this._model.replaceAll(),!0)}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}getGlobalBufferTerm(){return et(this,void 0,void 0,(function*(){return this._editor.getOption(33).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}))}setGlobalBufferTerm(e){this._editor.getOption(33).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};it.ID="editor.contrib.findController",it=je([Je(1,w.i6),Je(2,Xe.Uy),Je(3,Ge.p)],it);let st=class extends it{constructor(e,t,i,s,n,o,r,a){super(e,i,r,a),this._contextViewService=t,this._keybindingService=s,this._themeService=n,this._notificationService=o,this._widget=null,this._findOptionsWidget=null}_start(e){const t=Object.create(null,{_start:{get:()=>super._start}});return et(this,void 0,void 0,(function*(){this._widget||this._createFindWidget();const i=this._editor.getSelection();let s=!1;switch(this._editor.getOption(33).autoFindInSelection){case"always":s=!0;break;case"never":s=!1;break;case"multiline":s=!!i&&i.startLineNumber!==i.endLineNumber}e.updateSearchScope=s,yield t._start.call(this,e),this._widget&&(2===e.shouldFocus?this._widget.focusReplaceInput():1===e.shouldFocus&&this._widget.focusFindInput())}))}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new $e(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new se(this._editor,this._state,this._keybindingService,this._themeService))}};st=je([Je(1,ze.u),Je(2,w.i6),Je(3,Qe.d),Je(4,f.XE),Je(5,Ye.lT),Je(6,Xe.Uy),Je(7,Ge.p)],st);const nt=(0,a.rn)(new a.jY({id:k,label:s.N("startFindAction","Find"),alias:"Find",precondition:w.Ao.or(l.u.focus,w.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:Ze.eH.MenubarEditMenu,group:"3_find",title:s.N({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));nt.addImplementation(0,((e,t,i)=>{const s=it.get(t);return!!s&&s.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(33).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(33).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:t.getOption(33).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop})}));class ot extends a.R6{constructor(){super({id:T,label:s.N("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return et(this,void 0,void 0,(function*(){let e=it.get(t);e&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop}),e.setGlobalBufferTerm(e.getState().searchString))}))}}class rt extends a.R6{run(e,t){return et(this,void 0,void 0,(function*(){let e=it.get(t);e&&!this._run(e)&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(33).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(33).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop}),this._run(e))}))}}class at extends rt{constructor(){super({id:B,label:s.N("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:l.u.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:w.Ao.and(l.u.focus,E),primary:3,weight:100}]})}_run(e){return!!e.moveToNextMatch()&&(e.editor.pushUndoStop(),!0)}}class lt extends rt{constructor(){super({id:V,label:s.N("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:l.u.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:w.Ao.and(l.u.focus,E),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class dt extends a.R6{run(e,t){return et(this,void 0,void 0,(function*(){let e=it.get(t);if(!e)return;const i="selection"===t.getOption(33).seedSearchStringFromSelection;let s=null;"never"!==t.getOption(33).seedSearchStringFromSelection&&(s=tt(t,"single",i)),s&&e.setSearchString(s),this._run(e)||(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(33).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:i,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop}),this._run(e))}))}}class ht extends dt{constructor(){super({id:W,label:s.N("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:l.u.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class ct extends dt{constructor(){super({id:H,label:s.N("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:l.u.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const ut=(0,a.rn)(new a.jY({id:U,label:s.N("startReplace","Replace"),alias:"Replace",precondition:w.Ao.or(l.u.focus,w.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:Ze.eH.MenubarEditMenu,group:"3_find",title:s.N({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));ut.addImplementation(0,((e,t,i)=>{if(!t.hasModel()||t.getOption(79))return!1;const s=it.get(t);if(!s)return!1;const n=t.getSelection(),o=s.isFindInputFocused(),r=!n.isEmpty()&&n.startLineNumber===n.endLineNumber&&"never"!==t.getOption(33).seedSearchStringFromSelection&&!o,a=o||r?2:1;return s.start({forceRevealReplace:!0,seedSearchStringFromSelection:r?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(33).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:"never"!==t.getOption(33).seedSearchStringFromSelection,shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop})})),(0,a._K)(it.ID,st),(0,a.Qr)(ot),(0,a.Qr)(at),(0,a.Qr)(lt),(0,a.Qr)(ht),(0,a.Qr)(ct);const gt=a._l.bindToContribution(it.get);(0,a.fK)(new gt({id:q,precondition:L,handler:e=>e.closeFindWidget(),kbOpts:{weight:105,kbExpr:w.Ao.and(l.u.focus,w.Ao.not("isComposing")),primary:9,secondary:[1033]}})),(0,a.fK)(new gt({id:$,precondition:void 0,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:M.primary,mac:M.mac,win:M.win,linux:M.linux}})),(0,a.fK)(new gt({id:K,precondition:void 0,handler:e=>e.toggleWholeWords(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:F.primary,mac:F.mac,win:F.win,linux:F.linux}})),(0,a.fK)(new gt({id:Z,precondition:void 0,handler:e=>e.toggleRegex(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:O.primary,mac:O.mac,win:O.win,linux:O.linux}})),(0,a.fK)(new gt({id:G,precondition:void 0,handler:e=>e.toggleSearchScope(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:A.primary,mac:A.mac,win:A.win,linux:A.linux}})),(0,a.fK)(new gt({id:z,precondition:void 0,handler:e=>e.togglePreserveCase(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:P.primary,mac:P.mac,win:P.win,linux:P.linux}})),(0,a.fK)(new gt({id:Q,precondition:L,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:3094}})),(0,a.fK)(new gt({id:Q,precondition:L,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:w.Ao.and(l.u.focus,D),primary:3}})),(0,a.fK)(new gt({id:X,precondition:L,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:2563}})),(0,a.fK)(new gt({id:X,precondition:L,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:w.Ao.and(l.u.focus,D),primary:void 0,mac:{primary:2051}}})),(0,a.fK)(new gt({id:Y,precondition:L,handler:e=>e.selectAllMatches(),kbOpts:{weight:105,kbExpr:l.u.focus,primary:515}}))},62943:function(e,t,i){i.r(t),i.d(t,{FoldingController:function(){return Y},editorFoldForeground:function(){return ie},foldBackgroundBackground:function(){return te}});var s=i(63580),n=i(98401),o=i(97295),r=i(15393),a=i(22258),l=i(5976),d=i(16830),h=i(4669);const c=16777215,u=4278190080;class g{constructor(e,t,i){if(e.length!==t.length||e.length>65535)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new Uint32Array(Math.ceil(e.length/32)),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],t=(t,i)=>{let s=e[e.length-1];return this.getStartLineNumber(s)<=t&&this.getEndLineNumber(s)>=i};for(let i=0,s=this._startIndexes.length;i<s;i++){let s=this._startIndexes[i],n=this._endIndexes[i];if(s>c||n>c)throw new Error("startLineNumber or endLineNumber must not exceed 16777215");for(;e.length>0&&!t(s,n);)e.pop();let o=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=s+((255&o)<<24),this._endIndexes[i]=n+((65280&o)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&c}getEndLineNumber(e){return this._endIndexes[e]&c}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){let t=e/32|0,i=e%32;return 0!=(this._collapseStates[t]&1<<i)}setCollapsed(e,t){let i=e/32|0,s=e%32,n=this._collapseStates[i];this._collapseStates[i]=t?n|1<<s:n&~(1<<s)}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let s=0;s<this._types.length;s++)this._types[s]===e&&(this.setCollapsed(s,t),i=!0);return i}toRegion(e){return new p(this,e)}getParentIndex(e){this.ensureParentIndices();let t=((this._startIndexes[e]&u)>>>24)+((this._endIndexes[e]&u)>>>16);return 65535===t?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(0===i)return-1;for(;t<i;){let s=Math.floor((t+i)/2);e<this.getStartLineNumber(s)?i=s:t=s+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);-1!==t;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){let e=[];for(let t=0;t<this.length;t++)e[t]=`[${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}}class p{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class _{constructor(e,t){this._updateEventEmitter=new h.Q5,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new g(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[],this._isInitialized=!1}get regions(){return this._regions}get textModel(){return this._textModel}get isInitialized(){return this._isInitialized}toggleCollapseState(e){if(!e.length)return;e=e.sort(((e,t)=>e.regionIndex-t.regionIndex));const t={};this._decorationProvider.changeDecorations((i=>{let s=0,n=-1,o=-1;const r=e=>{for(;s<e;){const e=this._regions.getEndLineNumber(s),t=this._regions.isCollapsed(s);e<=n&&i.changeDecorationOptions(this._editorDecorationIds[s],this._decorationProvider.getDecorationOption(t,e<=o)),t&&e>o&&(o=e),s++}};for(let i of e){let e=i.regionIndex,s=this._editorDecorationIds[e];if(s&&!t[s]){t[s]=!0,r(e);let i=!this._regions.isCollapsed(e);this._regions.setCollapsed(e,i),n=Math.max(n,this._regions.getEndLineNumber(e))}}r(this._regions.length)})),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}update(e,t=[]){let i=[],s=-1,n=(n,o)=>{const r=e.getStartLineNumber(n),a=e.getEndLineNumber(n);o||(o=e.isCollapsed(n)),o&&((e,i)=>{for(let s of t)if(e<s&&s<=i)return!0;return!1})(r,a)&&(o=!1),e.setCollapsed(n,o);const l=this._textModel.getLineMaxColumn(r),d={startLineNumber:r,startColumn:Math.max(l-1,1),endLineNumber:r,endColumn:l};i.push({range:d,options:this._decorationProvider.getDecorationOption(o,a<=s)}),o&&a>s&&(s=a)},o=0,r=()=>{for(;o<this._regions.length;){let e=this._regions.isCollapsed(o);if(o++,e)return o-1}return-1},a=0,l=r();for(;-1!==l&&a<e.length;){let t=this._textModel.getDecorationRange(this._editorDecorationIds[l]);if(t){let i=t.startLineNumber;if(t.startColumn===Math.max(t.endColumn-1,1)&&this._textModel.getLineMaxColumn(i)===t.endColumn)for(;a<e.length;){let t=e.getStartLineNumber(a);if(!(i>=t))break;n(a,i===t),a++}}l=r()}for(;a<e.length;)n(a,!1),a++;this._editorDecorationIds=this._decorationProvider.deltaDecorations(this._editorDecorationIds,i),this._regions=e,this._isInitialized=!0,this._updateEventEmitter.fire({model:this})}getMemento(){let e=[];for(let t=0;t<this._regions.length;t++)if(this._regions.isCollapsed(t)){let i=this._textModel.getDecorationRange(this._editorDecorationIds[t]);if(i){let s=i.startLineNumber,n=i.endLineNumber+this._regions.getEndLineNumber(t)-this._regions.getStartLineNumber(t);e.push({startLineNumber:s,endLineNumber:n})}}if(e.length>0)return e}applyMemento(e){if(!Array.isArray(e))return;let t=[];for(let i of e){let e=this.getRegionAtLine(i.startLineNumber);e&&!e.isCollapsed&&t.push(e)}this.toggleCollapseState(t)}dispose(){this._decorationProvider.deltaDecorations(this._editorDecorationIds,[])}getAllRegionsAtLine(e,t){let i=[];if(this._regions){let s=this._regions.findRange(e),n=1;for(;s>=0;){let e=this._regions.toRegion(s);t&&!t(e,n)||i.push(e),n++,s=e.parentIndex}}return i}getRegionAtLine(e){if(this._regions){let t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){let i=[],s=e?e.regionIndex+1:0,n=e?e.endLineNumber:Number.MAX_VALUE;if(t&&2===t.length){const e=[];for(let o=s,r=this._regions.length;o<r;o++){let s=this._regions.toRegion(o);if(!(this._regions.getStartLineNumber(o)<n))break;for(;e.length>0&&!s.containedBy(e[e.length-1]);)e.pop();e.push(s),t(s,e.length)&&i.push(s)}}else for(let e=s,o=this._regions.length;e<o;e++){let s=this._regions.toRegion(e);if(!(this._regions.getStartLineNumber(e)<n))break;t&&!t(s)||i.push(s)}return i}}function m(e,t,i=Number.MAX_VALUE,s){let n=[];if(s&&s.length>0)for(let o of s){let s=e.getRegionAtLine(o);if(s&&(s.isCollapsed!==t&&n.push(s),i>1)){let o=e.getRegionsInside(s,((e,s)=>e.isCollapsed!==t&&s<i));n.push(...o)}}else{let s=e.getRegionsInside(null,((e,s)=>e.isCollapsed!==t&&s<i));n.push(...s)}e.toggleCollapseState(n)}function f(e,t,i,s){let n=[];for(let o of s){let s=e.getAllRegionsAtLine(o,((e,s)=>e.isCollapsed!==t&&s<=i));n.push(...s)}e.toggleCollapseState(n)}function v(e,t,i){let s=[];for(let t of i)s.push(e.getAllRegionsAtLine(t,void 0)[0]);let n=e.getRegionsInside(null,(e=>s.every((t=>!t.containedBy(e)&&!e.containedBy(t)))&&e.isCollapsed!==t));e.toggleCollapseState(n)}function S(e,t,i){let s=e.textModel,n=e.regions,o=[];for(let e=n.length-1;e>=0;e--)if(i!==n.isCollapsed(e)){let i=n.getStartLineNumber(e);t.test(s.getLineContent(i))&&o.push(n.toRegion(e))}e.toggleCollapseState(o)}function b(e,t,i){let s=e.regions,n=[];for(let e=s.length-1;e>=0;e--)i!==s.isCollapsed(e)&&t===s.getType(e)&&n.push(s.toRegion(e));e.toggleCollapseState(n)}var C=i(83103),N=i(73046),R=i(59554),x=i(97781);const I=(0,R.q5)("folding-expanded",N.lA.chevronDown,(0,s.N)("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),w=(0,R.q5)("folding-collapsed",N.lA.chevronRight,(0,s.N)("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin."));class y{constructor(e){this.editor=e,this.autoHideFoldingControls=!0,this.showFoldingHighlights=!0}getDecorationOption(e,t){return t?y.HIDDEN_RANGE_DECORATION:e?this.showFoldingHighlights?y.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:y.COLLAPSED_VISUAL_DECORATION:this.autoHideFoldingControls?y.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:y.EXPANDED_VISUAL_DECORATION}deltaDecorations(e,t){return this.editor.deltaDecorations(e,t)}changeDecorations(e){return this.editor.changeDecorations(e)}}y.COLLAPSED_VISUAL_DECORATION=C.qx.register({description:"folding-collapsed-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:x.kS.asClassName(w)}),y.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=C.qx.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",className:"folded-background",isWholeLine:!0,firstLineDecorationClassName:x.kS.asClassName(w)}),y.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=C.qx.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:x.kS.asClassName(I)}),y.EXPANDED_VISUAL_DECORATION=C.qx.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+x.kS.asClassName(I)}),y.HIDDEN_RANGE_DECORATION=C.qx.register({description:"folding-hidden-range-decoration",stickiness:1});var L=i(29102),E=i(24314),D=i(9488);class M{constructor(e){this._updateEventEmitter=new h.Q5,this._foldingModel=e,this._foldingModelListener=e.onDidChange((e=>this.updateHiddenRanges())),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}updateHiddenRanges(){let e=!1,t=[],i=0,s=0,n=Number.MAX_VALUE,o=-1,r=this._foldingModel.regions;for(;i<r.length;i++){if(!r.isCollapsed(i))continue;let a=r.getStartLineNumber(i)+1,l=r.getEndLineNumber(i);n<=a&&l<=o||(!e&&s<this._hiddenRanges.length&&this._hiddenRanges[s].startLineNumber===a&&this._hiddenRanges[s].endLineNumber===l?(t.push(this._hiddenRanges[s]),s++):(e=!0,t.push(new E.e(a,1,l,1))),n=a,o=l)}(e||s<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyMemento(e){if(!Array.isArray(e)||0===e.length)return!1;let t=[];for(let i of e){if(!i.startLineNumber||!i.endLineNumber)return!1;t.push(new E.e(i.startLineNumber+1,1,i.endLineNumber,1))}return this.applyHiddenRanges(t),!0}getMemento(){return this._hiddenRanges.map((e=>({startLineNumber:e.startLineNumber-1,endLineNumber:e.endLineNumber})))}applyHiddenRanges(e){this._hiddenRanges=e,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return null!==F(this._hiddenRanges,e)}adjustSelections(e){let t=!1,i=this._foldingModel.textModel,s=null,n=e=>(s&&function(e,t){return e>=t.startLineNumber&&e<=t.endLineNumber}(e,s)||(s=F(this._hiddenRanges,e)),s?s.startLineNumber-1:null);for(let s=0,o=e.length;s<o;s++){let o=e[s],r=n(o.startLineNumber);r&&(o=o.setStartPosition(r,i.getLineMaxColumn(r)),t=!0);let a=n(o.endLineNumber);a&&(o=o.setEndPosition(a,i.getLineMaxColumn(a)),t=!0),e[s]=o}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function F(e,t){let i=(0,D.lG)(e,(e=>t<e.startLineNumber))-1;return i>=0&&e[i].endLineNumber>=t?e[i]:null}var O=i(83831);class A{constructor(e){this.editorModel=e,this.id="indent"}dispose(){}compute(e){let t=O.zu.getFoldingRules(this.editorModel.getLanguageIdentifier().id),i=t&&!!t.offSide,s=t&&t.markers;return Promise.resolve(function(e,t,i,s=5e3){const n=e.getOptions().tabSize;let o,r=new P(s);i&&(o=new RegExp(`(${i.start.source})|(?:${i.end.source})`));let a=[],l=e.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let i=e.getLineCount();i>0;i--){let s,l=e.getLineContent(i),d=C.yO.computeIndentLevel(l,n),h=a[a.length-1];if(-1!==d){if(o&&(s=l.match(o))){if(!s[1]){a.push({indent:-2,endAbove:i,line:i});continue}{let e=a.length-1;for(;e>0&&-2!==a[e].indent;)e--;if(e>0){a.length=e+1,h=a[e],r.insertFirst(i,h.line,d),h.line=i,h.indent=d,h.endAbove=i;continue}}}if(h.indent>d){do{a.pop(),h=a[a.length-1]}while(h.indent>d);let e=h.endAbove-1;e-i>=1&&r.insertFirst(i,e,d)}h.indent===d?h.endAbove=i:a.push({indent:d,endAbove:i,line:i})}else t&&(h.endAbove=i)}return r.toIndentRanges(e)}(this.editorModel,i,s))}}class P{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>c||t>c)return;let s=this._length;this._startIndexes[s]=e,this._endIndexes[s]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let i=this._length-1,s=0;i>=0;i--,s++)e[s]=this._startIndexes[i],t[s]=this._endIndexes[i];return new g(e,t)}{let t=0,i=this._indentOccurrences.length;for(let e=0;e<this._indentOccurrences.length;e++){let s=this._indentOccurrences[e];if(s){if(s+t>this._foldingRangesLimit){i=e;break}t+=s}}const s=e.getOptions().tabSize;let n=new Uint32Array(this._foldingRangesLimit),o=new Uint32Array(this._foldingRangesLimit);for(let r=this._length-1,a=0;r>=0;r--){let l=this._startIndexes[r],d=e.getLineContent(l),h=C.yO.computeIndentLevel(d,s);(h<i||h===i&&t++<this._foldingRangesLimit)&&(n[a]=l,o[a]=this._endIndexes[r],a++)}return new g(n,o)}}}var k=i(44101),T=i(17301);const B={},V="syntax";class W{constructor(e,t,i,s=5e3){this.editorModel=e,this.providers=t,this.limit=s,this.id=V;for(const e of t)"function"==typeof e.onDidChange&&(this.disposables||(this.disposables=new l.SL),this.disposables.add(e.onDidChange(i)))}compute(e){return function(e,t,i){let s=null,n=e.map(((e,n)=>Promise.resolve(e.provideFoldingRanges(t,B,i)).then((e=>{if(!i.isCancellationRequested&&Array.isArray(e)){Array.isArray(s)||(s=[]);let i=t.getLineCount();for(let t of e)t.start>0&&t.end>t.start&&t.end<=i&&s.push({start:t.start,end:t.end,rank:n,kind:t.kind})}}),T.Cp)));return Promise.all(n).then((e=>s))}(this.providers,this.editorModel,e).then((e=>{if(e){return U(e,this.limit)}return null}))}dispose(){var e;null===(e=this.disposables)||void 0===e||e.dispose()}}class H{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,s){if(e>c||t>c)return;let n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._nestingLevels[n]=s,this._types[n]=i,this._length++,s<30&&(this._nestingLevelCounts[s]=(this._nestingLevelCounts[s]||0)+1)}toIndentRanges(){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let i=0;i<this._length;i++)e[i]=this._startIndexes[i],t[i]=this._endIndexes[i];return new g(e,t,this._types)}{let e=0,t=this._nestingLevelCounts.length;for(let i=0;i<this._nestingLevelCounts.length;i++){let s=this._nestingLevelCounts[i];if(s){if(s+e>this._foldingRangesLimit){t=i;break}e+=s}}let i=new Uint32Array(this._foldingRangesLimit),s=new Uint32Array(this._foldingRangesLimit),n=[];for(let o=0,r=0;o<this._length;o++){let a=this._nestingLevels[o];(a<t||a===t&&e++<this._foldingRangesLimit)&&(i[r]=this._startIndexes[o],s[r]=this._endIndexes[o],n[r]=this._types[o],r++)}return new g(i,s,n)}}}function U(e,t){let i,s=e.sort(((e,t)=>{let i=e.start-t.start;return 0===i&&(i=e.rank-t.rank),i})),n=new H(t),o=[];for(let e of s)if(i){if(e.start>i.start)if(e.end<=i.end)o.push(i),i=e,n.add(e.start,e.end,e.kind&&e.kind.value,o.length);else{if(e.start>i.end){do{i=o.pop()}while(i&&e.start>i.end);i&&o.push(i),i=e}n.add(e.start,e.end,e.kind&&e.kind.value,o.length)}}else i=e,n.add(e.start,e.end,e.kind&&e.kind.value,o.length);return n.toIndentRanges()}const q="init";class ${constructor(e,t,i,s){if(this.editorModel=e,this.id=q,t.length){let n=t=>({range:{startLineNumber:t.startLineNumber,startColumn:0,endLineNumber:t.endLineNumber,endColumn:e.getLineLength(t.endLineNumber)},options:{description:"folding-initializing-range-provider",stickiness:1}});this.decorationIds=e.deltaDecorations([],t.map(n)),this.timeout=setTimeout(i,s)}}dispose(){this.decorationIds&&(this.editorModel.deltaDecorations(this.decorationIds,[]),this.decorationIds=void 0),"number"==typeof this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}compute(e){let t=[];if(this.decorationIds)for(let e of this.decorationIds){let i=this.editorModel.getDecorationRange(e);i&&t.push({start:i.startLineNumber,end:i.endLineNumber,rank:1})}return Promise.resolve(U(t,Number.MAX_VALUE))}}var K=i(38819),Z=i(73910),G=i(39925),z=function(e,t,i,s){var n,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},Q=function(e,t){return function(i,s){t(i,s,e)}};const X=new K.uy("foldingEnabled",!1);let Y=class e extends l.JT{constructor(e,t){super(),this.contextKeyService=t,this.localToDispose=this._register(new l.SL),this.editor=e;const i=this.editor.getOptions();this._isEnabled=i.get(35),this._useFoldingProviders="indentation"!==i.get(36),this._unfoldOnClickAfterEndOfLine=i.get(39),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=i.get(38),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingStateMemento=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new y(e),this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===i.get(98),this.foldingDecorationProvider.showFoldingHighlights=i.get(37),this.foldingEnabled=X.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel((()=>this.onModelChanged()))),this._register(this.editor.onDidChangeConfiguration((e=>{if(e.hasChanged(35)&&(this._isEnabled=this.editor.getOptions().get(35),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),e.hasChanged(98)||e.hasChanged(37)){const e=this.editor.getOptions();this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===e.get(98),this.foldingDecorationProvider.showFoldingHighlights=e.get(37),this.onModelContentChanged()}e.hasChanged(36)&&(this._useFoldingProviders="indentation"!==this.editor.getOptions().get(36),this.onFoldingStrategyChanged()),e.hasChanged(39)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(39)),e.hasChanged(38)&&(this._foldingImportsByDefault=this.editor.getOptions().get(38))}))),this.onModelChanged()}static get(t){return t.getContribution(e.ID)}saveViewState(){let e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){let t=this.foldingModel.isInitialized?this.foldingModel.getMemento():this.hiddenRangeModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){let t=this.editor.getModel();if(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)return;if(!e||e.lineCount!==t.getLineCount())return;if(this._currentModelHasFoldedImports=!!e.foldedImports,!e.collapsedRegions)return;e.provider!==V&&e.provider!==q||(this.foldingStateMemento=e);const i=e.collapsedRegions;if(this.hiddenRangeModel.applyMemento(i)){const e=this.getFoldingModel();e&&e.then((e=>{if(e){this._restoringViewState=!0;try{e.applyMemento(i)}finally{this._restoringViewState=!1}}})).then(void 0,T.dL)}}onModelChanged(){this.localToDispose.clear();let e=this.editor.getModel();this._isEnabled&&e&&!e.isTooLargeForTokenization()&&(this._currentModelHasFoldedImports=!1,this.foldingModel=new _(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new M(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange((e=>this.onHiddenRangesChanges(e)))),this.updateScheduler=new r.vp(200),this.cursorChangedScheduler=new r.pY((()=>this.revealCursor()),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(k.aC.onDidChange((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelContent((()=>this.onModelContentChanged()))),this.localToDispose.add(this.editor.onDidChangeCursorPosition((()=>this.onCursorPositionChanged()))),this.localToDispose.add(this.editor.onMouseDown((e=>this.onEditorMouseDown(e)))),this.localToDispose.add(this.editor.onMouseUp((e=>this.onEditorMouseUp(e)))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler&&this.updateScheduler.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.foldingStateMemento=null,this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null}}),this.onModelContentChanged())}onFoldingStrategyChanged(){this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null,this.onModelContentChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;if(this.rangeProvider=new A(e),this._useFoldingProviders&&this.foldingModel){let t=k.aC.ordered(this.foldingModel.textModel);if(0===t.length&&this.foldingStateMemento&&this.foldingStateMemento.collapsedRegions){return this.rangeProvider=new $(e,this.foldingStateMemento.collapsedRegions,(()=>{this.foldingStateMemento=null,this.onFoldingStrategyChanged()}),3e4)}t.length>0&&(this.rangeProvider=new W(e,t,(()=>this.onModelContentChanged())))}return this.foldingStateMemento=null,this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onModelContentChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger((()=>{const e=this.foldingModel;if(!e)return null;const t=this.getRangeProvider(e.textModel);let i=this.foldingRegionPromise=(0,r.PG)((e=>t.compute(e)));return i.then((t=>{if(t&&i===this.foldingRegionPromise){let i;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const e=t.setCollapsedAllOfType(k.AD.Imports.value,!0);e&&(i=G.ZF.capture(this.editor),this._currentModelHasFoldedImports=e)}let s=this.editor.getSelections(),n=s?s.map((e=>e.startLineNumber)):[];e.update(t,n),i&&i.restore(this.editor)}return e}))})).then(void 0,(e=>((0,T.dL)(e),null))))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){let e=this.editor.getSelections();e&&this.hiddenRangeModel.adjustSelections(e)&&this.editor.setSelections(e)}this.editor.setHiddenAreas(e)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then((e=>{if(e){let t=this.editor.getSelections();if(t&&t.length>0){let i=[];for(let s of t){let t=s.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(t)&&i.push(...e.getAllRegionsAtLine(t,(e=>e.isCollapsed&&t>e.startLineNumber)))}i.length&&(e.toggleCollapseState(i),this.reveal(t[0].getPosition()))}}})).then(void 0,T.dL)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range)return;if(!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:const s=e.target.detail,n=e.target.element.offsetLeft;if(s.offsetX-n<5)return;i=!0;break;case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()){if(!e.target.detail.isAfterLines)break}return;case 6:if(this.hiddenRangeModel.hasRanges()){let e=this.editor.getModel();if(e&&t.startColumn===e.getLineMaxColumn(t.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.getFoldingModel();if(!t||!this.mouseDownInfo||!e.target)return;let i=this.mouseDownInfo.lineNumber,s=this.mouseDownInfo.iconClicked,n=e.target.range;if(n&&n.startLineNumber===i){if(s){if(4!==e.target.type)return}else{let e=this.editor.getModel();if(!e||n.startColumn!==e.getLineMaxColumn(i))return}t.then((t=>{if(t){let n=t.getRegionAtLine(i);if(n&&n.startLineNumber===i){let o=n.isCollapsed;if(s||o){let s=[];if(e.event.altKey){let e=e=>!e.containedBy(n)&&!n.containedBy(e),i=t.getRegionsInside(null,e);for(const e of i)e.isCollapsed&&s.push(e);0===s.length&&(s=i)}else{let i=e.event.middleButton||e.event.shiftKey;if(i)for(const e of t.getRegionsInside(n))e.isCollapsed===o&&s.push(e);!o&&i&&0!==s.length||s.push(n)}t.toggleCollapseState(s),this.reveal({lineNumber:i,column:1})}}}})).then(void 0,T.dL)}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};Y.ID="editor.contrib.folding",Y=z([Q(1,K.i6)],Y);class j extends d.R6{runEditorCommand(e,t,i){let s=Y.get(t);if(!s)return;let n=s.getFoldingModel();return n?(this.reportTelemetry(e,t),n.then((e=>{if(e){this.invoke(s,e,t,i);const n=t.getSelection();n&&s.reveal(n.getStartPosition())}}))):void 0}getSelectedLines(e){let t=e.getSelections();return t?t.map((e=>e.startLineNumber)):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map((e=>e+1)):this.getSelectedLines(t)}run(e,t){}}function J(e){if(!n.o8(e)){if(!n.Kn(e))return!1;const t=e;if(!n.o8(t.levels)&&!n.hj(t.levels))return!1;if(!n.o8(t.direction)&&!n.HD(t.direction))return!1;if(!(n.o8(t.selectionLines)||n.kJ(t.selectionLines)&&t.selectionLines.every(n.hj)))return!1}return!0}class ee extends j{getFoldingLevel(){return parseInt(this.id.substr(ee.ID_PREFIX.length))}invoke(e,t,i){!function(e,t,i,s){let n=e.getRegionsInside(null,((e,n)=>n===t&&e.isCollapsed!==i&&!s.some((t=>e.containsLine(t)))));e.toggleCollapseState(n)}(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}}ee.ID_PREFIX="editor.foldLevel",ee.ID=e=>ee.ID_PREFIX+e;(0,d._K)(Y.ID,Y),(0,d.Qr)(class extends j{constructor(){super({id:"editor.unfold",label:s.N("unfoldAction.label","Unfold"),alias:"Unfold",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:3161,mac:{primary:2649},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t",constraint:J,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,s){let n=s&&s.levels||1,o=this.getLineNumbers(s,i);s&&"up"===s.direction?f(t,!1,n,o):m(t,!1,n,o)}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.unfoldRecursively",label:s.N("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2137),weight:100}})}invoke(e,t,i,s){m(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.fold",label:s.N("foldAction.label","Fold"),alias:"Fold",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:3159,mac:{primary:2647},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t",constraint:J,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,s){let n=this.getLineNumbers(s,i);const o=s&&s.levels,r=s&&s.direction;"number"!=typeof o&&"string"!=typeof r?function(e,t,i){let s=[];for(let n of i){let i=e.getAllRegionsAtLine(n,(e=>e.isCollapsed!==t));i.length>0&&s.push(i[0])}e.toggleCollapseState(s)}(t,!0,n):"up"===r?f(t,!0,o||1,n):m(t,!0,o||1,n)}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.foldRecursively",label:s.N("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2135),weight:100}})}invoke(e,t,i){let s=this.getSelectedLines(i);m(t,!0,Number.MAX_VALUE,s)}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.foldAll",label:s.N("foldAllAction.label","Fold All"),alias:"Fold All",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2069),weight:100}})}invoke(e,t,i){m(t,!0)}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.unfoldAll",label:s.N("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2088),weight:100}})}invoke(e,t,i){m(t,!1)}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.foldAllBlockComments",label:s.N("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2133),weight:100}})}invoke(e,t,i){if(t.regions.hasTypes())b(t,k.AD.Comment.value,!0);else{const e=i.getModel();if(!e)return;let s=O.zu.getComments(e.getLanguageIdentifier().id);if(s&&s.blockCommentStartToken){S(t,new RegExp("^\\s*"+(0,o.ec)(s.blockCommentStartToken)),!0)}}}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.foldAllMarkerRegions",label:s.N("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2077),weight:100}})}invoke(e,t,i){if(t.regions.hasTypes())b(t,k.AD.Region.value,!0);else{const e=i.getModel();if(!e)return;let s=O.zu.getFoldingRules(e.getLanguageIdentifier().id);if(s&&s.markers&&s.markers.start){S(t,new RegExp(s.markers.start),!0)}}}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:s.N("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2078),weight:100}})}invoke(e,t,i){if(t.regions.hasTypes())b(t,k.AD.Region.value,!1);else{const e=i.getModel();if(!e)return;let s=O.zu.getFoldingRules(e.getLanguageIdentifier().id);if(s&&s.markers&&s.markers.start){S(t,new RegExp(s.markers.start),!1)}}}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.foldAllExcept",label:s.N("foldAllExcept.label","Fold All Regions Except Selected"),alias:"Fold All Regions Except Selected",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2131),weight:100}})}invoke(e,t,i){v(t,!0,this.getSelectedLines(i))}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.unfoldAllExcept",label:s.N("unfoldAllExcept.label","Unfold All Regions Except Selected"),alias:"Unfold All Regions Except Selected",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2129),weight:100}})}invoke(e,t,i){v(t,!1,this.getSelectedLines(i))}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.toggleFold",label:s.N("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2090),weight:100}})}invoke(e,t,i){!function(e,t,i){let s=[];for(let n of i){let i=e.getRegionAtLine(n);if(i){const n=!i.isCollapsed;if(s.push(i),t>1){let o=e.getRegionsInside(i,((e,i)=>e.isCollapsed!==n&&i<t));s.push(...o)}}}e.toggleCollapseState(s)}(t,1,this.getSelectedLines(i))}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.gotoParentFold",label:s.N("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,weight:100}})}invoke(e,t,i){let s=this.getSelectedLines(i);if(s.length>0){let e=function(e,t){let i=null,s=t.getRegionAtLine(e);if(null!==s&&(i=s.startLineNumber,e===i)){let e=s.parentIndex;i=-1!==e?t.regions.getStartLineNumber(e):null}return i}(s[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.gotoPreviousFold",label:s.N("gotoPreviousFold.label","Go to Previous Fold"),alias:"Go to Previous Fold",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,weight:100}})}invoke(e,t,i){let s=this.getSelectedLines(i);if(s.length>0){let e=function(e,t){let i=t.getRegionAtLine(e);if(null!==i){if(e!==i.startLineNumber)return i.startLineNumber;{let e=i.parentIndex;if(-1===e)return null;let s=t.regions.getStartLineNumber(i.parentIndex);for(;null!==i;){if(!(i.regionIndex>0))return null;if(i=t.regions.toRegion(i.regionIndex-1),i.startLineNumber<=s)return null;if(i.parentIndex===e)return i.startLineNumber}}}return null}(s[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}),(0,d.Qr)(class extends j{constructor(){super({id:"editor.gotoNextFold",label:s.N("gotoNextFold.label","Go to Next Fold"),alias:"Go to Next Fold",precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,weight:100}})}invoke(e,t,i){let s=this.getSelectedLines(i);if(s.length>0){let e=function(e,t){let i=t.getRegionAtLine(e);if(null!==i){let e=i.parentIndex;if(-1===e)return null;let s=t.regions.getEndLineNumber(i.parentIndex);for(;null!==i;){if(!(i.regionIndex<t.regions.length))return null;if(i=t.regions.toRegion(i.regionIndex+1),i.startLineNumber>=s)return null;if(i.parentIndex===e)return i.startLineNumber}}return null}(s[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}});for(let e=1;e<=7;e++)(0,d.QG)(new ee({id:ee.ID(e),label:s.N("foldLevelAction.label","Fold Level {0}",e),alias:`Fold Level ${e}`,precondition:X,kbOpts:{kbExpr:L.u.editorTextFocus,primary:(0,a.gx)(2089,2048|21+e),weight:100}}));const te=(0,Z.P6)("editor.foldBackground",{light:(0,Z.Zn)(Z.hE,.3),dark:(0,Z.Zn)(Z.hE,.3),hc:null},s.N("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0),ie=(0,Z.P6)("editorGutter.foldingControlForeground",{dark:Z.XZ,light:Z.XZ,hc:Z.XZ},s.N("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));(0,x.Ic)(((e,t)=>{const i=e.getColor(te);i&&t.addRule(`.monaco-editor .folded-background { background-color: ${i}; }`);const s=e.getColor(ie);s&&t.addRule(`\n\t\t.monaco-editor .cldr${x.kS.asCSSSelector(I)},\n\t\t.monaco-editor .cldr${x.kS.asCSSSelector(w)} {\n\t\t\tcolor: ${s} !important;\n\t\t}\n\t\t`)}))}}]);